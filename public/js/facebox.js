!function(e){function o(o){if(e.facebox.settings.inited)return!0;var a;e.facebox.settings.inited=!0,e(document).trigger("init.facebox"),(a=e.facebox.settings).loadingImage=a.loading_image||a.loadingImage,a.closeImage=a.close_image||a.closeImage,a.imageTypes=a.image_types||a.imageTypes,a.faceboxHtml=a.facebox_html||a.faceboxHtml;var c=e.facebox.settings.imageTypes.join("|");e.facebox.settings.imageTypesRegexp=new RegExp("."+c+"$","i"),o&&e.extend(e.facebox.settings,o),e("body").append(e.facebox.settings.faceboxHtml);var t=[new Image,new Image];t[0].src=e.facebox.settings.closeImage,t[1].src=e.facebox.settings.loadingImage,e("#facebox").find(".b:first, .bl, .br, .tl, .tr").each(function(){t.push(new Image),t.slice(-1).src=e(this).css("background-image").replace(/url\((.+)\)/,"$1")}),e("#facebox .close").click(e.facebox.close),e("#facebox .close_image").attr("src",e.facebox.settings.closeImage)}function a(){var e,o;return self.pageYOffset?(o=self.pageYOffset,e=self.pageXOffset):document.documentElement&&document.documentElement.scrollTop?(o=document.documentElement.scrollTop,e=document.documentElement.scrollLeft):document.body&&(o=document.body.scrollTop,e=document.body.scrollLeft),new Array(e,o)}function c(){var e;return self.innerHeight?e=self.innerHeight:document.documentElement&&document.documentElement.clientHeight?e=document.documentElement.clientHeight:document.body&&(e=document.body.clientHeight),e}function t(o,a){if(o.match(/#/)){var c=window.location.href.split("#")[0],t=o.replace(c,"");e.facebox.reveal(e(t).clone().show(),a)}else o.match(e.facebox.settings.imageTypesRegexp)?n(o,a):i(o,a)}function n(o,a){var c=new Image;c.onload=function(){e.facebox.reveal('<div class="image"><img src="'+c.src+'" /></div>',a)},c.src=o}function i(o,a){e.get(o,function(o){e.facebox.reveal(o,a)})}function s(){return 0==e.facebox.settings.overlay||null===e.facebox.settings.opacity}e.facebox=function(o,a){e.facebox.loading(),o.ajax?i(o.ajax):o.image?n(o.image):o.div?t(o.div):e.isFunction(o)?o.call(e):e.facebox.reveal(o,a)},e.extend(e.facebox,{settings:{opacity:.5,overlay:!0,loadingImage:webroot+"images/facebox/loading.gif",closeImage:webroot+"images/facebox/close.gif",imageTypes:["png","jpg","jpeg","gif"],faceboxHtml:'    <div id="facebox" style="display:none;">       <div class="popup">         <table>           <tbody>             <tr>                <td class="body">                 <div class="content">                 </div>                 <div class="footer">                   <a href="javascript:void(0);" class="close">                     <img src="'+webroot+'images/facebox/close.gif" title="close" class="close_image" />                   </a>                 </div>               </td>              </tr>           </tbody>         </table>       </div>     </div>'},loading:function(){if(o(),1==e("#facebox .loading").length)return!0;!function(){if(s())return;0==e("facebox_overlay").length&&e("body").append('<div id="facebox_overlay" class="facebox_hide"></div>');e("#facebox_overlay").hide().addClass("facebox_overlayBG").css("opacity",e.facebox.settings.opacity).click(function(){e(document).trigger("")}).fadeIn(200)}(),e("#facebox .content").empty(),e("#facebox .body").children().hide().end().append('<div class="loading"><img src="'+e.facebox.settings.loadingImage+'"/></div>'),e("#facebox").css({top:a()[1]+c()/10,left:385.5}).show(),e(document).bind("keydown.facebox",function(o){return 27==o.keyCode&&e.facebox.close(),!0}),e(document).trigger("loading.facebox")},reveal:function(o,a){e(document).trigger("beforeReveal.facebox"),a&&e("#facebox .content").addClass(a),e("#facebox .content").append(o),e("#facebox .loading").remove(),e("#facebox .body").children().fadeIn("normal"),e("#facebox").css("left",e(window).width()/2-e("#facebox table").width()/2),e(document).trigger("reveal.facebox").trigger("afterReveal.facebox")},close:function(){return e(document).trigger("close.facebox"),!1}}),e.fn.facebox=function(a){return o(a),this.click(function(){e.facebox.loading(!0);var o=this.rel.match(/facebox\[?\.(\w+)\]?/);return o&&(o=o[1]),t(this.href,o),!1})},e(document).bind("close.facebox",function(){e(document).unbind("keydown.facebox"),e("#facebox").fadeOut(function(){e("#facebox .content").removeClass().addClass("content"),function(){if(!s())e("#facebox_overlay").fadeOut(200,function(){e("#facebox_overlay").removeClass("facebox_overlayBG"),e("#facebox_overlay").addClass("facebox_hide"),e("#facebox_overlay").remove()})}(),e("#facebox .loading").remove()})})}(jQuery);